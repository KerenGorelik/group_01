<!DOCTYPE html>
<html>
<head>
    <title>FLYTAU ADMIN- Add Classes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
<div class="corner-logo">
  <a href="{{ url_for('landing_page') }}">
    <img src="{{ url_for('static', filename='flytau_logo_circle.png') }}" alt="FLYTAU">
  </a>
</div>

<h1>Add Class seating</h1>

<form method="post" id="classForm">

  {% if error %}
    <div class="form-error">{{ error }}</div>
  {% endif %}

  <div class="form-note">
    Number of seats will be calculated automatically based on the rows and columns you define below.
  </div>

  {% if size == 'LARGE' %}
    <h2>Business Class</h2>

    <input type="number" id="bus_first_row" name="bus_first_row" placeholder="First row" min="1" required>
    <input type="number" id="bus_last_row"  name="bus_last_row"  placeholder="Last row"  min="1" required>

    <input type="text" id="bus_first_col" name="bus_first_col" placeholder="First column (A-Z)"
           maxlength="1" pattern="[A-Za-z]" required>
    <input type="text" id="bus_last_col"  name="bus_last_col"  placeholder="Last column (A-Z)"
           maxlength="1" pattern="[A-Za-z]" required>
  {% endif %}

  <h2>Economy Class</h2>

  <input type="number" id="eco_first_row" name="eco_first_row" placeholder="First row" min="1" required>
  <input type="number" id="eco_last_row"  name="eco_last_row"  placeholder="Last row"  min="1" required>

  <input type="text" id="eco_first_col" name="eco_first_col" placeholder="First column (A-Z)"
         maxlength="1" pattern="[A-Za-z]" required>
  <input type="text" id="eco_last_col"  name="eco_last_col"  placeholder="Last column (A-Z)"
         maxlength="1" pattern="[A-Za-z]" required>

  <button type="submit">Save Classes</button>
</form>

<form method="GET" action="{{ url_for('admin_dashboard') }}">
  <button type="submit">Back to Admin</button>
</form>

<script>
  // Rule: no "gap" between classes.
  // If Business exists (size == LARGE), then Economy first row must be Business last row + 1.
  document.getElementById('classForm').addEventListener('submit', function (e) {
    const busLastEl = document.getElementById('bus_last_row'); // exists only when LARGE
    if (!busLastEl) return; // no business class -> nothing to validate here

    const busLast = parseInt(busLastEl.value, 10);
    const ecoFirst = parseInt(document.getElementById('eco_first_row').value, 10);

    if (Number.isNaN(busLast) || Number.isNaN(ecoFirst)) return;

    if (ecoFirst !== busLast + 1) {
      e.preventDefault(); // stop POST -> prevents creating/updating classes
      alert(`Not logical: Economy must start at row ${busLast + 1} because Business ends at row ${busLast}.`);
    }
  });
</script>

</body>
</html>
